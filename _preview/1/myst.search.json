{"version":"1","records":[{"hierarchy":{"lvl1":"Snow Observations Cookbook"},"type":"lvl1","url":"/","position":0},{"hierarchy":{"lvl1":"Snow Observations Cookbook"},"content":"\n\n\n\n\n\n\n\n\n\nThis Project Pythia Cookbook is a compilation of tutorials and training\nmaterials in support of the NASA snow reserach community. Some tutorials\ncome from the 2020 to 2024 SnowEx Hackweek program hosted at the UW eScience\nInstitute. Other materials are drawn from the NASA Goddard “SnowPit” Science\nTask Group or STG. The purpose of the tutorials is to help people with data\naccess and to demonstrate a variety of disciplinary use cases.","type":"content","url":"/","position":1},{"hierarchy":{"lvl1":"Snow Observations Cookbook","lvl2":"Motivation"},"type":"lvl2","url":"/#motivation","position":2},{"hierarchy":{"lvl1":"Snow Observations Cookbook","lvl2":"Motivation"},"content":"There are numerous data products and methods for accessing and analyzing\nsnow observations. These include field, airborne, and satellite missions.\nThe goal of these tutorials is to streamline data access, reduce duplication\nof effort and build an open science community around snow research\ndatasets, algorithms and software.","type":"content","url":"/#motivation","position":3},{"hierarchy":{"lvl1":"Snow Observations Cookbook","lvl2":"Authors"},"type":"lvl2","url":"/#authors","position":4},{"hierarchy":{"lvl1":"Snow Observations Cookbook","lvl2":"Authors"},"content":"Zach Fair\n\n\nAnthony Arendt,\n\n\nMark Welden-Smith\n\nmore to be added","type":"content","url":"/#authors","position":5},{"hierarchy":{"lvl1":"Snow Observations Cookbook","lvl3":"Contributors","lvl2":"Authors"},"type":"lvl3","url":"/#contributors","position":6},{"hierarchy":{"lvl1":"Snow Observations Cookbook","lvl3":"Contributors","lvl2":"Authors"},"content":"","type":"content","url":"/#contributors","position":7},{"hierarchy":{"lvl1":"Snow Observations Cookbook","lvl2":"Structure"},"type":"lvl2","url":"/#structure","position":8},{"hierarchy":{"lvl1":"Snow Observations Cookbook","lvl2":"Structure"},"content":"This cookbook is broken up into three main sections: “Data Access”, “Observations”, and “Analysis and Machine Learning”. The current listing of subtopics is currently a work in progress.","type":"content","url":"/#structure","position":9},{"hierarchy":{"lvl1":"Snow Observations Cookbook","lvl3":"Section 1: Data Access","lvl2":"Structure"},"type":"lvl3","url":"/#section-1-data-access","position":10},{"hierarchy":{"lvl1":"Snow Observations Cookbook","lvl3":"Section 1: Data Access","lvl2":"Structure"},"content":"Field Campaigns Overview\n\nSnowExSQL Database","type":"content","url":"/#section-1-data-access","position":11},{"hierarchy":{"lvl1":"Snow Observations Cookbook","lvl3":"Section 2: Observations","lvl2":"Structure"},"type":"lvl3","url":"/#section-2-observations","position":12},{"hierarchy":{"lvl1":"Snow Observations Cookbook","lvl3":"Section 2: Observations","lvl2":"Structure"},"content":"GPR and Lidar\n\nTime-lapse Cameras\n\nUAVSAR\n\nMicrostructure\n\nAVIRIS-NG\n\nTerrestrial Laser Scanning","type":"content","url":"/#section-2-observations","position":13},{"hierarchy":{"lvl1":"Snow Observations Cookbook","lvl3":"Section 3: Analysis and Machine Learning","lvl2":"Structure"},"type":"lvl3","url":"/#section-3-analysis-and-machine-learning","position":14},{"hierarchy":{"lvl1":"Snow Observations Cookbook","lvl3":"Section 3: Analysis and Machine Learning","lvl2":"Structure"},"content":"Neural Networks with PyTorch\n\nSnow Modeling\n\nUCLA Reanalysis\n\nMERRA-2\n\nERA5","type":"content","url":"/#section-3-analysis-and-machine-learning","position":15},{"hierarchy":{"lvl1":"Snow Observations Cookbook","lvl2":"Running the Notebooks"},"type":"lvl2","url":"/#running-the-notebooks","position":16},{"hierarchy":{"lvl1":"Snow Observations Cookbook","lvl2":"Running the Notebooks"},"content":"You can either run the notebook using\n\n\nBinder or on your local machine.","type":"content","url":"/#running-the-notebooks","position":17},{"hierarchy":{"lvl1":"Snow Observations Cookbook","lvl3":"Running on Binder","lvl2":"Running the Notebooks"},"type":"lvl3","url":"/#running-on-binder","position":18},{"hierarchy":{"lvl1":"Snow Observations Cookbook","lvl3":"Running on Binder","lvl2":"Running the Notebooks"},"content":"The simplest way to interact with a Jupyter Notebook is through\n\n\nBinder, which enables the execution of a\n\n\nJupyter Book in the cloud. The details of\nhow this works are not important for now. All you need to know is how to launch\na Pythia Cookbooks chapter via Binder. Simply navigate your mouse to\nthe top right corner of the book chapter you are viewing and click\non the rocket ship icon, (see figure below), and be sure to select\n“launch Binder”. After a moment you should be presented with a\nnotebook that you can interact with. I.e. you’ll be able to execute\nand even change the example programs. You’ll see that the code cells\nhave no output at first, until you execute them by pressing\nShift+Enter. Complete details on how to interact with\na live Jupyter notebook are described in \n\nGetting Started with\nJupyter.\n\nNote, not all Cookbook chapters are executable. If you do not see\nthe rocket ship icon, such as on this page, you are not viewing an\nexecutable book chapter.","type":"content","url":"/#running-on-binder","position":19},{"hierarchy":{"lvl1":"Snow Observations Cookbook","lvl3":"Running on Your Own Machine","lvl2":"Running the Notebooks"},"type":"lvl3","url":"/#running-on-your-own-machine","position":20},{"hierarchy":{"lvl1":"Snow Observations Cookbook","lvl3":"Running on Your Own Machine","lvl2":"Running the Notebooks"},"content":"If you are interested in running this material locally on your computer,\nyou will need to follow this workflow:\n\nClone the https://github.com/ProjectPythia/snow-cookbook repository: git clone https://github.com/ProjectPythia/snow-cookbook.git\n\nMove into the snow-cookbook directorycd snow-cookbook\n\nCreate and activate your conda environment from the environment.yml fileconda env create -f environment.yml\nconda activate snow-cookbook\n\nMove into the notebooks directory and start up Jupyterlabcd notebooks/\njupyter lab","type":"content","url":"/#running-on-your-own-machine","position":21},{"hierarchy":{"lvl1":"GPR and Lidar"},"type":"lvl1","url":"/notebooks/gpr-lidar-hackweektutorial","position":0},{"hierarchy":{"lvl1":"GPR and Lidar"},"content":"","type":"content","url":"/notebooks/gpr-lidar-hackweektutorial","position":1},{"hierarchy":{"lvl1":"GPR and Lidar","lvl2":"Author: Randall Bonnell"},"type":"lvl2","url":"/notebooks/gpr-lidar-hackweektutorial#author-randall-bonnell","position":2},{"hierarchy":{"lvl1":"GPR and Lidar","lvl2":"Author: Randall Bonnell"},"content":"","type":"content","url":"/notebooks/gpr-lidar-hackweektutorial#author-randall-bonnell","position":3},{"hierarchy":{"lvl1":"GPR and Lidar","lvl2":"Outline:"},"type":"lvl2","url":"/notebooks/gpr-lidar-hackweektutorial#outline","position":4},{"hierarchy":{"lvl1":"GPR and Lidar","lvl2":"Outline:"},"content":"GPR Methods for the Retrieval of Snow Depth and SWE\n\nLidar Methods for Snow Depth Retrieval and SWE Estimation\n\nLeveraging Coincident GPR and Lidar Data Sets to Derive Snow Density\n\nSnowEx23 GPR/Lidar Derived Permittivities/Densities in the Boreal Forest, Alaska\n\nDiscussion: Improving Density Estimation\n\nGPR SnowEx Analysis-Ready Datasets\n\nReferences\n\n\n\n","type":"content","url":"/notebooks/gpr-lidar-hackweektutorial#outline","position":5},{"hierarchy":{"lvl1":"GPR and Lidar","lvl2":"1. GPR Methods for the Retrieval of Snow Depth and SWE"},"type":"lvl2","url":"/notebooks/gpr-lidar-hackweektutorial#id-1-gpr-methods-for-the-retrieval-of-snow-depth-and-swe","position":6},{"hierarchy":{"lvl1":"GPR and Lidar","lvl2":"1. GPR Methods for the Retrieval of Snow Depth and SWE"},"content":"","type":"content","url":"/notebooks/gpr-lidar-hackweektutorial#id-1-gpr-methods-for-the-retrieval-of-snow-depth-and-swe","position":7},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"Previous GPR tutorial developed by Tate Meehan (CRREL) that may be of interest: https://​snowex​-2021​.hackweek​.io​/tutorials​/gpr​/gpr​.html","lvl2":"1. GPR Methods for the Retrieval of Snow Depth and SWE"},"type":"lvl3","url":"/notebooks/gpr-lidar-hackweektutorial#previous-gpr-tutorial-developed-by-tate-meehan-crrel-that-may-be-of-interest-https-snowex-2021-hackweek-io-tutorials-gpr-gpr-html","position":8},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"Previous GPR tutorial developed by Tate Meehan (CRREL) that may be of interest: https://​snowex​-2021​.hackweek​.io​/tutorials​/gpr​/gpr​.html","lvl2":"1. GPR Methods for the Retrieval of Snow Depth and SWE"},"content":"","type":"content","url":"/notebooks/gpr-lidar-hackweektutorial#previous-gpr-tutorial-developed-by-tate-meehan-crrel-that-may-be-of-interest-https-snowex-2021-hackweek-io-tutorials-gpr-gpr-html","position":9},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"SnowEx Review","lvl2":"1. GPR Methods for the Retrieval of Snow Depth and SWE"},"type":"lvl3","url":"/notebooks/gpr-lidar-hackweektutorial#snowex-review","position":10},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"SnowEx Review","lvl2":"1. GPR Methods for the Retrieval of Snow Depth and SWE"},"content":"Ground-based, airborne, and satellite radars were operated as part of the NASA SnowEx campaigns.\n\nGround-based radars included ground-penetrating radar (GPR), frequency-modulated continuous-wave radar (FMCW), and tower mounted radars.\n\nWhat airborne and satellite radars were tasked?","type":"content","url":"/notebooks/gpr-lidar-hackweektutorial#snowex-review","position":11},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"A Brief Blurb on Radar Physics","lvl2":"1. GPR Methods for the Retrieval of Snow Depth and SWE"},"type":"lvl3","url":"/notebooks/gpr-lidar-hackweektutorial#a-brief-blurb-on-radar-physics","position":12},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"A Brief Blurb on Radar Physics","lvl2":"1. GPR Methods for the Retrieval of Snow Depth and SWE"},"content":"Radar is fully transmissible in dry snow, but there is frequency-dependent interaction between the radar signal and the snowpack.\n\nAt L-band frequencies (1–2 GHz, ~25 cm wavelength) there limited to no interaction with the snowpack.","type":"content","url":"/notebooks/gpr-lidar-hackweektutorial#a-brief-blurb-on-radar-physics","position":13},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"What is GPR?","lvl2":"1. GPR Methods for the Retrieval of Snow Depth and SWE"},"type":"lvl3","url":"/notebooks/gpr-lidar-hackweektutorial#what-is-gpr","position":14},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"What is GPR?","lvl2":"1. GPR Methods for the Retrieval of Snow Depth and SWE"},"content":"We use L-band GPR, which was operated during all SnowEx campaigns!\n\nGPR transmits a radar signal into the snowpack, which then reflects off objects/interfaces with contrasting dielectric permittivity. The GPR records the amplitude and two-way travel time (twt) of the reflections.\n\nDielectric permittivity refers to the dielectric properties of the snowpack that define how EM energy transmits through the medium.\n\nUsually, we are interested in the snow-ground interface and we measure the snowpack thickness in twt (nanoseconds).\n\nHowever, in complex vegetation, radargrams are difficult to interpret! Causes increased uncertainty.\n\nSee radargram examples below for the boreal forest GPR surveys (credit Kajsa Holland-Goon).\n\n\n\n","type":"content","url":"/notebooks/gpr-lidar-hackweektutorial#what-is-gpr","position":15},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"Snow Depth, SWE, and Density Calculations","lvl2":"1. GPR Methods for the Retrieval of Snow Depth and SWE"},"type":"lvl3","url":"/notebooks/gpr-lidar-hackweektutorial#snow-depth-swe-and-density-calculations","position":16},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"Snow Depth, SWE, and Density Calculations","lvl2":"1. GPR Methods for the Retrieval of Snow Depth and SWE"},"content":"To calculate snow depth (d_s) from twt, we need to estimate the relative permittivity (\\epsilon_s) and radar velocity (v_s) of the snowpack:\n\nv_s = \\frac{c}{\\sqrt{\\epsilon_s}}; --> Where c is the velocity of EM energy in a vacuum.\n\n\\epsilon_s = (1+\\frac{0.845\\rho_s}{1000})^2; --> Kovacs et al. (1995), but more than 19 equations exist for dry snow conditions.\n\nd_s = \\frac{twt}{2}*v_s;\n\nSWE = d_s\\rho_s;--> Where SWE is snow water equivalent.\n\nBut...If we know the snow depth, we can constrain the radar velocity and estimate relative permittivity and density!\n\n\\epsilon_s=(\\frac{c*twt}{2d_s})^2\n\n\\rho_s=(\\sqrt{\\epsilon_s}-1)\\frac{1000}{0.845}\n\nHow can we find the snow depth?","type":"content","url":"/notebooks/gpr-lidar-hackweektutorial#snow-depth-swe-and-density-calculations","position":17},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"A Shameless Plug...","lvl2":"1. GPR Methods for the Retrieval of Snow Depth and SWE"},"type":"lvl3","url":"/notebooks/gpr-lidar-hackweektutorial#a-shameless-plug","position":18},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"A Shameless Plug...","lvl2":"1. GPR Methods for the Retrieval of Snow Depth and SWE"},"content":"Most analysis-ready GPR products have twt, snow depth, and snow water equivalent. Some have been updated with derived snow densities. See 6. SnowEx GPR Analysis-Ready Datasets below.\n\n","type":"content","url":"/notebooks/gpr-lidar-hackweektutorial#a-shameless-plug","position":19},{"hierarchy":{"lvl1":"GPR and Lidar","lvl2":"2. Lidar Methods for Snow Depth Retrieval and SWE Estimation"},"type":"lvl2","url":"/notebooks/gpr-lidar-hackweektutorial#id-2-lidar-methods-for-snow-depth-retrieval-and-swe-estimation","position":20},{"hierarchy":{"lvl1":"GPR and Lidar","lvl2":"2. Lidar Methods for Snow Depth Retrieval and SWE Estimation"},"content":"","type":"content","url":"/notebooks/gpr-lidar-hackweektutorial#id-2-lidar-methods-for-snow-depth-retrieval-and-swe-estimation","position":21},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"Previous lidar tutorial developed by Naheem Adebisi (ESRI) that may be of interest: https://​snowex​-2022​.hackweek​.io​/tutorials​/lidar​/index​.html","lvl2":"2. Lidar Methods for Snow Depth Retrieval and SWE Estimation"},"type":"lvl3","url":"/notebooks/gpr-lidar-hackweektutorial#previous-lidar-tutorial-developed-by-naheem-adebisi-esri-that-may-be-of-interest-https-snowex-2022-hackweek-io-tutorials-lidar-index-html","position":22},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"Previous lidar tutorial developed by Naheem Adebisi (ESRI) that may be of interest: https://​snowex​-2022​.hackweek​.io​/tutorials​/lidar​/index​.html","lvl2":"2. Lidar Methods for Snow Depth Retrieval and SWE Estimation"},"content":"","type":"content","url":"/notebooks/gpr-lidar-hackweektutorial#previous-lidar-tutorial-developed-by-naheem-adebisi-esri-that-may-be-of-interest-https-snowex-2022-hackweek-io-tutorials-lidar-index-html","position":23},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"A (Very) General Review of Lidar","lvl2":"2. Lidar Methods for Snow Depth Retrieval and SWE Estimation"},"type":"lvl3","url":"/notebooks/gpr-lidar-hackweektutorial#a-very-general-review-of-lidar","position":24},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"A (Very) General Review of Lidar","lvl2":"2. Lidar Methods for Snow Depth Retrieval and SWE Estimation"},"content":"Lidar emits photons and measures the twt of the returned photons\n\nThese twt are converted to elevation surfaces (e.g., DEM, DTM, DSM).\n\nLidar can be collected from a variety of platforms:\n\nTerrestrial\n\nUAV\n\nAirborne\n\nSatellite\n\nTwo acquisitions are required for snow, a snow-on acquisition and a snow-off acquisition. Snow depth can be calculated in two general ways:\n\nRaster-based approaches (see figure below, credit Airborne Snow Observatories Inc.)\n\nPoint cloud approaches","type":"content","url":"/notebooks/gpr-lidar-hackweektutorial#a-very-general-review-of-lidar","position":25},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"How is SWE calculated from lidar snow depths?","lvl2":"2. Lidar Methods for Snow Depth Retrieval and SWE Estimation"},"type":"lvl3","url":"/notebooks/gpr-lidar-hackweektutorial#how-is-swe-calculated-from-lidar-snow-depths","position":26},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"How is SWE calculated from lidar snow depths?","lvl2":"2. Lidar Methods for Snow Depth Retrieval and SWE Estimation"},"content":"At larger scales, SWE is calculated via modeled densities (e.g., M3 Works and ASO).\n\nAt smaller field sites, it may be appropriate to use representative in situ measurements.\n\n\n\n","type":"content","url":"/notebooks/gpr-lidar-hackweektutorial#how-is-swe-calculated-from-lidar-snow-depths","position":27},{"hierarchy":{"lvl1":"GPR and Lidar","lvl2":"3. Leveraging Coincident GPR and Lidar Data Sets to Derive Snow Density"},"type":"lvl2","url":"/notebooks/gpr-lidar-hackweektutorial#id-3-leveraging-coincident-gpr-and-lidar-data-sets-to-derive-snow-density","position":28},{"hierarchy":{"lvl1":"GPR and Lidar","lvl2":"3. Leveraging Coincident GPR and Lidar Data Sets to Derive Snow Density"},"content":"Density, liquid water content, and relative permittivity are understudied relative to snow depth and/or SWE.\n\nCombined coincident snow depths and twt can yield spatially distributed measurements of relative permittivity.\n\nIn wet snow, relative permittivity can be converted to liquid water content (e.g., Webb et al., 2018, 2020, 2022; Bonnell et al., 2021).\n\nIn dry snow, density can be estimated from the relative permittivity (Yildiz et al., 2021; McGrath et al., 2022; Bonnell et al., 2023; Meehan et al., 2024).\n\nThis technique has provided an unprecedented glimpse into the spatial properties of these parameters!\n\nCritically, studies have noted a large random error in derived products that should be considered (see figure below, credit: Meehan et al., 2024).\n\n\n\n","type":"content","url":"/notebooks/gpr-lidar-hackweektutorial#id-3-leveraging-coincident-gpr-and-lidar-data-sets-to-derive-snow-density","position":29},{"hierarchy":{"lvl1":"GPR and Lidar","lvl2":"4. SnowEx23 GPR/Lidar Derived Permittivities/Densities in the Boreal Forest, Alaska"},"type":"lvl2","url":"/notebooks/gpr-lidar-hackweektutorial#id-4-snowex23-gpr-lidar-derived-permittivities-densities-in-the-boreal-forest-alaska","position":30},{"hierarchy":{"lvl1":"GPR and Lidar","lvl2":"4. SnowEx23 GPR/Lidar Derived Permittivities/Densities in the Boreal Forest, Alaska"},"content":"","type":"content","url":"/notebooks/gpr-lidar-hackweektutorial#id-4-snowex23-gpr-lidar-derived-permittivities-densities-in-the-boreal-forest-alaska","position":31},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"Here, we will use this approach to derive densities at Farmer’s Loop Creamer’s Field during the SnowEx23 Alaska Campaign","lvl2":"4. SnowEx23 GPR/Lidar Derived Permittivities/Densities in the Boreal Forest, Alaska"},"type":"lvl3","url":"/notebooks/gpr-lidar-hackweektutorial#here-we-will-use-this-approach-to-derive-densities-at-farmers-loop-creamers-field-during-the-snowex23-alaska-campaign","position":32},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"Here, we will use this approach to derive densities at Farmer’s Loop Creamer’s Field during the SnowEx23 Alaska Campaign","lvl2":"4. SnowEx23 GPR/Lidar Derived Permittivities/Densities in the Boreal Forest, Alaska"},"content":"Lidar data was collected on 11 March 2023\n\nGPR data was collected on 7, 11, 13, and 16 March 2023\n\n#1.1 Load relevant packages\nimport os\nimport numpy as np \nfrom datetime import date\nfrom scipy.spatial import cKDTree\n\n#packages for figures\nimport matplotlib.pyplot as plt\nfrom rasterio.plot import show\n\n#geospatial packages\nimport geopandas as gpd #for vector data\nimport xarray as xr\nimport pandas as pd\nfrom shapely.geometry import box, Point\nimport rasterio as rio\n\n#Import SnowEx database\nfrom snowexsql.api import PointMeasurements, LayerMeasurements, RasterMeasurements\n\n\n","type":"content","url":"/notebooks/gpr-lidar-hackweektutorial#here-we-will-use-this-approach-to-derive-densities-at-farmers-loop-creamers-field-during-the-snowex23-alaska-campaign","position":33},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"Part 1: Load the GPR data from the SnowEx data base","lvl2":"4. SnowEx23 GPR/Lidar Derived Permittivities/Densities in the Boreal Forest, Alaska"},"type":"lvl3","url":"/notebooks/gpr-lidar-hackweektutorial#part-1-load-the-gpr-data-from-the-snowex-data-base","position":34},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"Part 1: Load the GPR data from the SnowEx data base","lvl2":"4. SnowEx23 GPR/Lidar Derived Permittivities/Densities in the Boreal Forest, Alaska"},"content":"-Huge thank you to Micah Johnson and Micah Sandusky for their support!\n\nNote that if we used the full GPR/Lidar dataset, we would need to allocate way more memory. This example focuses on a single date of collection in very dense forest.\n\nExamine the headers from the GPR csv --> what are the variables that we are interested in?\n\n# 1.2 Load GPR data\n\n#Note, memory space is fairly limited, will need to pull only one date\n\n#Set a number of dates to pull GPR for\n#dt1 = date(2023, 3, 7)\ndt2 = date(2023, 3, 11)\n#dt3 = date(2023, 3, 13)\n#dt4 = date(2023, 3, 16)\n\n#site1 = LayerMeasurements.from_filter(date=dt1, site_name='Fairbanks', site_id='FLCF', limit=1)\nsite2 = LayerMeasurements.from_filter(date=dt2, site_name='Fairbanks', site_id='FLCF', limit=1)\n#site3 = LayerMeasurements.from_filter(date=dt3, site_name='Fairbanks', site_id='FLCF', limit=1)\n#site4 = LayerMeasurements.from_filter(date=dt4, site_name='Fairbanks', site_id='FLCF', limit=1)\n\n#Use pandas ot read in csv data\n#gpr_df_dt1 = PointMeasurements.from_area(pt=site1.geometry[0], crs=26906, buffer=10000,\n#    type='two_way_travel',\n#    observers='Randall Bonnell',\n#    date=dt1, site_name='farmers-creamers',\n#    limit=29432)#The number of expected measurements\ngpr_df_dt2 = PointMeasurements.from_area(pt=site2.geometry[0], crs=26906, buffer=10000,\n    type='two_way_travel',\n    observers='Randall Bonnell',\n    date=dt2, site_name='farmers-creamers',\n    limit=20213)#The number of expected measurements\n#gpr_df_dt3 = PointMeasurements.from_area(pt=site3.geometry[0], crs=26906, buffer=10000,\n#    type='two_way_travel',\n#    observers='Randall Bonnell',\n#    date=dt3, site_name='farmers-creamers',\n#    limit=19024)\n#gpr_df_dt4 = PointMeasurements.from_area(pt=site4.geometry[0], crs=26906, buffer=10000,\n#    type='two_way_travel',\n#    observers='Randall Bonnell',\n#    date=dt4, site_name='farmers-creamers',\n#    limit=15785)\n\n\n#Compile into one dataframe\n#flcf_gpr_df = pd.concat([gpr_df_dt1,gpr_df_dt2,gpr_df_dt3,gpr_df_dt4],axis=0, join='outer', ignore_index=True, keys=None, levels=None,names=None,verify_integrity=False,sort=False,copy=None)\nflcf_gpr_df = gpr_df_dt2\n#Print out the csv headers and initial entries --> What's important here and what do we need?\nprint(flcf_gpr_df.head())\n\n# Let's look at the distribution of gpr two-way travel times and estimated snow depths\n#Estimate snow depths from twt by assuming a velocity of 0.25 m/ns --> Is this an appropriate velocity estimate?\nflcf_gpr_df['Depth_estimated'] = (flcf_gpr_df['value']/2)*0.25\n\nax1 = flcf_gpr_df.plot.hist(column=[\"value\"], edgecolor='black', title='two-way travel time (ns)')\nax2 = flcf_gpr_df.plot.hist(column=[\"Depth_estimated\"], edgecolor='black', title='Snow depth (m)')\n\n#Extract x/y limits from GPR data --> these will be used when loading the lidar snow depths\nbounds = flcf_gpr_df.total_bounds\n\n# Create a bounding box\ngpr_limits = box(*bounds)\n\n","type":"content","url":"/notebooks/gpr-lidar-hackweektutorial#part-1-load-the-gpr-data-from-the-snowex-data-base","position":35},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"Let’s load in the lidar canopy heights and snow depths.","lvl2":"4. SnowEx23 GPR/Lidar Derived Permittivities/Densities in the Boreal Forest, Alaska"},"type":"lvl3","url":"/notebooks/gpr-lidar-hackweektutorial#lets-load-in-the-lidar-canopy-heights-and-snow-depths","position":36},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"Let’s load in the lidar canopy heights and snow depths.","lvl2":"4. SnowEx23 GPR/Lidar Derived Permittivities/Densities in the Boreal Forest, Alaska"},"content":"We’ll look at the canopy heights to get an idea of what kind of forest the data were collected in.\n\nThen, we’ll look at the lidar snow depths to visualize the snow distribution.","type":"content","url":"/notebooks/gpr-lidar-hackweektutorial#lets-load-in-the-lidar-canopy-heights-and-snow-depths","position":37},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"Discussion questions:","lvl2":"4. SnowEx23 GPR/Lidar Derived Permittivities/Densities in the Boreal Forest, Alaska"},"type":"lvl3","url":"/notebooks/gpr-lidar-hackweektutorial#discussion-questions","position":38},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"Discussion questions:","lvl2":"4. SnowEx23 GPR/Lidar Derived Permittivities/Densities in the Boreal Forest, Alaska"},"content":"What type of survey design was implemented for the GPR?\n\nDo the lidar snow depth patterns seem to exhibit any kind of dependence upon the forest cover?\n\n","type":"content","url":"/notebooks/gpr-lidar-hackweektutorial#discussion-questions","position":39},{"hierarchy":{"lvl1":"GPR and Lidar","lvl2":"Commented until we fix reading of raster data"},"type":"lvl2","url":"/notebooks/gpr-lidar-hackweektutorial#commented-until-we-fix-reading-of-raster-data","position":40},{"hierarchy":{"lvl1":"GPR and Lidar","lvl2":"Commented until we fix reading of raster data"},"content":"\n\n# # 1.3 Load Lidar vegetation/canopy heights --> This may take a few minutes\n# #Read in the canopy heights raster from Farmer's Loop/Creamer's Field Alaska\n# flcf_ch = RasterMeasurements.from_area(shp = gpr_limits, crs=26906,\n#     buffer=None, type='canopy_height',\n#     site_name='farmers-creamers',\n#     observers='chris larsen')\n# print(flcf_ch)\n\n# #Plot the datasets\n# fig, ax = plt.subplots()\n# show(flcf_ch, ax=ax, cmap='Greens', clim=(0,5), title = 'Canopy Height (m)')\n# #Plot the GPR points on top\n# flcf_gpr_df.plot(ax=ax, color='blue', markersize = 10)\n\n# # 1.4 Load Lidar Snow depths --> This will take a few minutes\n\n# #Read in the canopy heights raster from Farmer's Loop/Creamer's Field Alaska\n# flcf_ds = RasterMeasurements.from_area(shp = gpr_limits, crs=26906,\n#     buffer=None, type='depth',\n#     site_name='farmers-creamers',\n#     observers='chris larsen')\n\n# #Plot the datasets\n# fig, ax = plt.subplots()\n# show(flcf_ds, ax=ax, cmap='Blues', clim=(0,1.5), title='Snow Depth (m)')\n# #Plot the GPR points on top\n# flcf_gpr_df.plot(ax=ax, color='red', markersize = 10)\n\n","type":"content","url":"/notebooks/gpr-lidar-hackweektutorial#commented-until-we-fix-reading-of-raster-data","position":41},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"Part 2: Match the GPR data to the lidar grid and derive relative permittivity and density","lvl2":"Commented until we fix reading of raster data"},"type":"lvl3","url":"/notebooks/gpr-lidar-hackweektutorial#part-2-match-the-gpr-data-to-the-lidar-grid-and-derive-relative-permittivity-and-density","position":42},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"Part 2: Match the GPR data to the lidar grid and derive relative permittivity and density","lvl2":"Commented until we fix reading of raster data"},"content":"There are two conceptual paths forward:\n\nRasterize the GPR data or\n\nVectorize the lidar data\n\nFor simplicity, the following code:\n\nvectorizes the lidar data\n\nperforms a nearest neighbor search between the lidar and GPR coordinate vectors\n\nCalculates the median GPR twt from the nearest neighbors\n\nDerives relative permittivity and density from the lidar snow depths and median twt\n\n","type":"content","url":"/notebooks/gpr-lidar-hackweektutorial#part-2-match-the-gpr-data-to-the-lidar-grid-and-derive-relative-permittivity-and-density","position":43},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"We need to know the resolutions of the lidar and GPR datasets","lvl2":"Commented until we fix reading of raster data"},"type":"lvl3","url":"/notebooks/gpr-lidar-hackweektutorial#we-need-to-know-the-resolutions-of-the-lidar-and-gpr-datasets","position":44},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"We need to know the resolutions of the lidar and GPR datasets","lvl2":"Commented until we fix reading of raster data"},"content":"The GPR dataset consists of points that are spaced ~0.10 m apart.\n\nWhat about the lidar? Run the code block below to answer this question.\n\nHow many GPR points would you expect to have per lidar pixel? Assume linear transects through each pixel.\n\n# #2.1 Let's learn a bit about the resolution of the lidar rasters\n\n# height, width = flcf_ds.read(1).shape #Find the height and width of the array\n\n# #Use meshgrid to create two arrays matching the height/width of the input raster\n# #The GPR dataset consists of vectors --> we will eventually need to vectorize these lidar arrays\n# cols, rows = np.meshgrid(np.arange(width), np.arange(height)) \n\n\n# #Extract the easting/northing from the raster \n# x_lidar, y_lidar = rio.transform.xy(flcf_ds.transform, rows, cols) \n\n# #What's the resolution of the lidar dataset?\n# print(\"The x resolution of the snow depth raster is:\",x_lidar[0][1]-x_lidar[0][0])\n# print(\"The y resolution of the snow depth raster is:\",y_lidar[0][0]-y_lidar[1][0])\n\n\n# # 2.2 Matching GPR to the lidar grid\n\n# #Two conceptual paths forward: rasterize the GPR data, or convert lidar data to points\n\n# #Let's vectorize the raster data\n# x_lidar_vec = np.array(x_lidar).flatten()\n# y_lidar_vec = np.array(y_lidar).flatten()\n# flcf_ds_vec = flcf_ds.read().flatten()\n\n# #Pull vectors from geo dataframe\n# gpr_arr = np.stack([flcf_gpr_df.geometry.x, flcf_gpr_df.geometry.y,flcf_gpr_df['value']], axis=1)\n# gpr_x=gpr_arr[:,0]\n# gpr_y=gpr_arr[:,1]\n# gpr_twt=gpr_arr[:,2].reshape(len(gpr_arr[:,2]),1)\n\n\n# #2.3 Create sets of coordinates for the nearest neighbors search\n# coordinates_set1 = np.column_stack((x_lidar_vec,y_lidar_vec))\n# coordinates_set2 = np.column_stack((gpr_x,gpr_y))\n\n# # Build KDTree from the second set of coordinates\n# tree = cKDTree(coordinates_set2)\n\n# # Define the radius (in meters)\n# radius = 0.25\n\n# # Function to find the median of travel times within a radius --> Credit where credit is due, this function was generated in part by chatgpt\n# def find_median_travel_time_within_radius(point, tree, coordinates_set1, gpr_twt, radius):\n#     indices = tree.query_ball_point(point, radius)\n#     if indices:\n#         # Retrieve travel times for the nearest neighbors\n#         neighbor_twt = gpr_twt[indices]\n#         median_twt = np.median(neighbor_twt)\n#         return median_twt\n#     else:\n#         return np.nan  # Return NaN if no neighbors are within the radius\n# # Find medians for each lidar point\n# medians = np.array([find_median_travel_time_within_radius(point, tree, coordinates_set2, gpr_twt, radius) for point in coordinates_set1])\n\n\n","type":"content","url":"/notebooks/gpr-lidar-hackweektutorial#we-need-to-know-the-resolutions-of-the-lidar-and-gpr-datasets","position":45},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"The GPR data is not as spatially continuous as the lidar data, so most of the median twt dataset consists of nan’s","lvl2":"Commented until we fix reading of raster data"},"type":"lvl3","url":"/notebooks/gpr-lidar-hackweektutorial#the-gpr-data-is-not-as-spatially-continuous-as-the-lidar-data-so-most-of-the-median-twt-dataset-consists-of-nans","position":46},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"The GPR data is not as spatially continuous as the lidar data, so most of the median twt dataset consists of nan’s","lvl2":"Commented until we fix reading of raster data"},"content":"Let’s remove the nan’s to free up memory and reduce processing time.\n\n# #At this point, all lidar points should have an associated gpr twt --> most are likely nan's though. But let's check!\n# print(\"The gpr array has size:\",medians.shape)\n# print(\"The lidar array has size:\",flcf_ds_vec.shape)\n\n\n# #2.4 Before we get to the math part, let's clear out the nan's from all important vectors:\n# #Create mask for gpr medians that are nan's\n# mask = np.isnan(medians)\n\n# #Remove entries from the lidar snow depth, x, and y vectors that align with the nan twt values\n# flcf_ds_vec_clean = flcf_ds_vec[~mask]\n# coordinates_set1_clean=coordinates_set1[~mask]\n\n# #Lastly, remove entries from the twt medians\n# medians_clean = medians[~mask]\n\n# #Let's check the new size of the twt array\n# print(medians_clean.shape)\n\n\n\n","type":"content","url":"/notebooks/gpr-lidar-hackweektutorial#the-gpr-data-is-not-as-spatially-continuous-as-the-lidar-data-so-most-of-the-median-twt-dataset-consists-of-nans","position":47},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"Discussion questions:","lvl2":"Commented until we fix reading of raster data"},"type":"lvl3","url":"/notebooks/gpr-lidar-hackweektutorial#discussion-questions-1","position":48},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"Discussion questions:","lvl2":"Commented until we fix reading of raster data"},"content":"Roughly, how many points were removed?\n\nWhen we are done, we will have derived 3788 snow density estimates. In the same area, about four snow pits were dug, resulting in four bulk density measurements. How useful do you think our data will be?\n\nIs more always better?","type":"content","url":"/notebooks/gpr-lidar-hackweektutorial#discussion-questions-1","position":49},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"Let’s now transition to the relative permittivity and density calculations","lvl2":"Commented until we fix reading of raster data"},"type":"lvl3","url":"/notebooks/gpr-lidar-hackweektutorial#lets-now-transition-to-the-relative-permittivity-and-density-calculations","position":50},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"Let’s now transition to the relative permittivity and density calculations","lvl2":"Commented until we fix reading of raster data"},"content":"\n\n# #2.5 We finally get to the math part!!\n# #Let's calculate relative permittivity first...\n# c=0.2998#The speed of light in a vacuum\n# e_s = ((c * medians_clean) / (2 * flcf_ds_vec_clean)) ** 2\n\n# #And then calculate density\n# rho_s = ((np.sqrt(e_s) - 1) / 0.845) * 1000\n\n","type":"content","url":"/notebooks/gpr-lidar-hackweektutorial#lets-now-transition-to-the-relative-permittivity-and-density-calculations","position":51},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"Part 3: Examining the derived densities","lvl2":"Commented until we fix reading of raster data"},"type":"lvl3","url":"/notebooks/gpr-lidar-hackweektutorial#part-3-examining-the-derived-densities","position":52},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"Part 3: Examining the derived densities","lvl2":"Commented until we fix reading of raster data"},"content":"\n\n# # 3.1 Finally, let's take a peek at what the derived densities look like...\n# plt.figure()\n# plt.scatter(coordinates_set1_clean[:,0], coordinates_set1_clean[:,1], s=10, c=rho_s, cmap='viridis', clim=(0, 500), edgecolor=None)\n\n# # Add colorbar to show the scale of color values\n# plt.colorbar()\n# plt.title('Snow Density (kg m-3)')\n\n# # Show the plot\n# plt.show()\n\n# # 3.2 What does the histogram distribution look like??\n# # Define bin edges\n# bin_edges = np.arange(np.min(rho_s), np.max(rho_s), 25)  # Create bin edges from min(x) to max(x) with step size 25\n\n# # Create the histogram\n# plt.figure()  # Create a new figure\n# plt.hist(rho_s, bins=bin_edges, edgecolor=None)  # Plot histogram with specified bin edges\n\n# plt.title('Snow Density Histogram')\n\n# # Show the plot\n# plt.show()\n\n# #Let's zoom in a little...\n# # Define bin edges\n# bin_edges = np.arange(0, 500, 25)  # Create bin edges from min(x) to max(x) with step size 25\n\n# # Create the histogram\n# plt.figure()  # Create a new figure\n# plt.hist(rho_s, bins=bin_edges, edgecolor='black')  # Plot histogram with specified bin edges\n\n# plt.title('Snow Density Histogram')\n\n# # Show the plot\n# plt.show()\n\n","type":"content","url":"/notebooks/gpr-lidar-hackweektutorial#part-3-examining-the-derived-densities","position":53},{"hierarchy":{"lvl1":"GPR and Lidar","lvl2":"5. Discussion: Improving Density Estimation"},"type":"lvl2","url":"/notebooks/gpr-lidar-hackweektutorial#id-5-discussion-improving-density-estimation","position":54},{"hierarchy":{"lvl1":"GPR and Lidar","lvl2":"5. Discussion: Improving Density Estimation"},"content":"What do you think? Do the derived densities look usable at this stage?","type":"content","url":"/notebooks/gpr-lidar-hackweektutorial#id-5-discussion-improving-density-estimation","position":55},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"What contributes to the random error?","lvl2":"5. Discussion: Improving Density Estimation"},"type":"lvl3","url":"/notebooks/gpr-lidar-hackweektutorial#what-contributes-to-the-random-error","position":56},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"What contributes to the random error?","lvl2":"5. Discussion: Improving Density Estimation"},"content":"There are three groups of factors that control the random error:\n\nMeasurement accuracy for lidar snow depths and GPR twt. Reduced accuracy for either or both of the techniques will lead to large errors. The boreal forest had a lot of complex vegetation that may have impeded the accuracy of these instruments.\n\nDepth of the snowpack. The accuracy of the lidar is not a function of snow depth. Thus, the random errors reduce as the snow depth increases. The boreal forest snow depths were shallow!\n\nGeolocation alignment. GPR coordinates were post-processed, but accuracy is still likely on the order of ±3 m.\n\n","type":"content","url":"/notebooks/gpr-lidar-hackweektutorial#what-contributes-to-the-random-error","position":57},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"Improving the derived densities","lvl2":"5. Discussion: Improving Density Estimation"},"type":"lvl3","url":"/notebooks/gpr-lidar-hackweektutorial#improving-the-derived-densities","position":58},{"hierarchy":{"lvl1":"GPR and Lidar","lvl3":"Improving the derived densities","lvl2":"5. Discussion: Improving Density Estimation"},"content":"Let’s say we want to learn something about snow density in the boreal forest. The derived densities offer a HUGE increase in the number of available density measurements compared to in situ. But, in situ are much more accurate. How can we improve this dataset?\n\nIncrease the footprint of the derived densities by upsampling the lidar (e.g., to 3 m).\n\nThis will reduce the impact of GPR geolocation accuracy and the lidar/GPR observation uncertainty.\n\nNeed to be careful! The GPR footprint is large, but it may not scale well past 3 m.\n\nRemove erroneous values.\n\nHow does the lidar survey time compare with the GPR survey time? Was the snow disturbed or did more snow accumulate between surveys?\n\nRelative permittivity of snow cannot be less than air (\\epsilon_a = 1.0) or greater than liquid water (\\epsilon_w = 88).\n\nFor dry snow, relative permittivity is usually between 1.0 and 2.0. The removal of values outside a certain number of standard deviations and/or the interquartile range may be warranted.\n\nRun a spatial averaging filter.\n\nOur surveys were primarily spirals --> should pair nicely with such a filter!\n\nExperiment with the window size of the filter. How would a 5 m x 5 m filter compare to a 25 m x 25 m filter?\n\nShould the data be parsed into different forest cover classes before such a filter is run?\n\nBe careful of linear transects! Large windows tend to remove any density variability along such transects.\n\nOnce you reach this point, it is likely that the densities will be analysis ready. You could run a predictive model to fill in the void spaces, use the densities to evaluate models, calculate experimental variograms, etc.\n\n","type":"content","url":"/notebooks/gpr-lidar-hackweektutorial#improving-the-derived-densities","position":59},{"hierarchy":{"lvl1":"GPR and Lidar","lvl2":"6. SnowEx GPR Analysis-Ready Datasets"},"type":"lvl2","url":"/notebooks/gpr-lidar-hackweektutorial#id-6-snowex-gpr-analysis-ready-datasets","position":60},{"hierarchy":{"lvl1":"GPR and Lidar","lvl2":"6. SnowEx GPR Analysis-Ready Datasets"},"content":"Grand Mesa, Colorado (SnowEx 2017, 2020)\n\nWebb et al. (2019). \n\nWebb et al. (2019)\n\nBonnell et al. (2021). \n\nBonnell et al. (2021)\n\nMeehan (2021). \n\nMeehan (2021)\n\nWebb (2021). \n\nWebb (2021)\n\nMeehan & Hojatimalekshah (2024). \n\nMeehan & Hojatimalekshah (2024)\n\nCameron Pass, Colorado (SnowEx 2020, 2021)\n\nMcGrath et al. (2021). \n\nMcGrath et al. (2021)\n\nBonnell et al. (2022). \n\nBonnell et al. (2022)\n\nBonnell et al. (2024). \n\nBonnell et al. (2024)\n\nJemez Mountains, New Mexico (SnowEx 2020)\n\nWebb (2021). \n\nWebb (2021)\n\nArctic Coastal Plains, Alaska (SnowEx 2023)\n\nWebb (2024). \n\nWebb (2024)\n\n","type":"content","url":"/notebooks/gpr-lidar-hackweektutorial#id-6-snowex-gpr-analysis-ready-datasets","position":61},{"hierarchy":{"lvl1":"GPR and Lidar","lvl2":"7. References"},"type":"lvl2","url":"/notebooks/gpr-lidar-hackweektutorial#id-7-references","position":62},{"hierarchy":{"lvl1":"GPR and Lidar","lvl2":"7. References"},"content":"Lidar Datasets\n\nLarsen (2024). \n\nLarsen (2024)\n\nRelevant GPR LWC Studies\n\nWebb et al. (2018). \n\nWebb et al. (2018)\n\nWebb et al. (2020). \n\nWebb et al. (2020)\n\nBonnell et al. (2021). \n\nBonnell et al. (2021)\n\nWebb et al. (2022). \n\nWebb et al. (2022)\n\nRelevant GPR Density Studies\n\nYildiz et al. (2021). \n\nYildiz et al. (2021)\n\nMcGrath et al. (2022). \n\nMcGrath et al. (2022)\n\nBonnell et al. (2023). \n\nBonnell et al. (2023)\n\nMeehan et al. (2024). \n\nMeehan et al. (2024)","type":"content","url":"/notebooks/gpr-lidar-hackweektutorial#id-7-references","position":63},{"hierarchy":{"lvl1":"How to Cite This Cookbook"},"type":"lvl1","url":"/notebooks/how-to-cite","position":0},{"hierarchy":{"lvl1":"How to Cite This Cookbook"},"content":"The material in this Project Pythia Cookbook is licensed for free and open consumption and reuse. All code is served under \n\nApache 2.0, while all non-code content is licensed under \n\nCreative Commons BY 4.0 (CC BY 4.0). Effectively, this means you are free to share and adapt this material so long as you give appropriate credit to the Cookbook authors and the Project Pythia community.\n\nThe source code for the book is \n\nreleased on GitHub and archived on Zenodo. This DOI will always resolve to the latest release of the book source:\n\n","type":"content","url":"/notebooks/how-to-cite","position":1},{"hierarchy":{"lvl1":"Field Campaigns Overview"},"type":"lvl1","url":"/notebooks/snowex-data-overview","position":0},{"hierarchy":{"lvl1":"Field Campaigns Overview"},"content":"\n\n","type":"content","url":"/notebooks/snowex-data-overview","position":1},{"hierarchy":{"lvl1":"Field Campaigns Overview"},"type":"lvl1","url":"/notebooks/snowex-data-overview#field-campaigns-overview","position":2},{"hierarchy":{"lvl1":"Field Campaigns Overview"},"content":"(5 minutes)\n\nBy: Megan Mason (NASA Goddard / SSAI) \n\nmegan​.a​.mason@nasa​.gov\n\nSupport by:  Carrie Vuyovich (NASA Goddard), Hans-Peter Marshall (Boise State), Svetlana Stuefer (University of Alaska Fairbanks)\n\nLearning Objectives\n\nVisual overview of the NASA SnowEx field campaigns\n\nGet a sense for the extent of data coverage\n\n\n\n","type":"content","url":"/notebooks/snowex-data-overview#field-campaigns-overview","position":3},{"hierarchy":{"lvl1":"Field Campaigns Overview","lvl2":"Data Coverage"},"type":"lvl2","url":"/notebooks/snowex-data-overview#data-coverage","position":4},{"hierarchy":{"lvl1":"Field Campaigns Overview","lvl2":"Data Coverage"},"content":"Each year we build upon our efforts to further investigate snow remote sensing science gaps identified in the NASA SnowEx Science Plan \n\n(Durand et al., 2016). The summary table lists the focus for each campaign by year and type. There are two different campaign types (IOP vs. TS); both result in the same types of measurements and data products. Depending on the  research application it may not matter at all which you choose to work with, or even combine! The important thing to grasp is the difference in spatial and temporal extent of the campaign periods. If the sampling protocols or data products change over time, it is for the sake of improvement. When possible, we aim to keep things consistent to continue to build a legacy data set.\n\nYear\n\nCampaign Type\n\nMeasurement Focus\n\n2017\n\nIOP\n\nColorado, focused on multiple instruments in a forest gradient.\n\n2020\n\nIOP, TS\n\nWestern U.S focused on Time Series of L-band InSAR, active/passive microwave for SWE and thermal IR for snow surface temp.\n\n2021\n\nTS\n\nWestern U.S, continued Time Series of L-band InSAR, also addressed prairie & snow albedo questions.\n\n2023\n\nIOP\n\nAlaska Tundra & Boreal forest, focused on addressing SWE/snow depth and albedo objectives.\n\n*IOP=Intense Observation Period (~2-3 week, daily observations) *; TS=Time Series (~3-5 month winter, weekly observations)\n\n","type":"content","url":"/notebooks/snowex-data-overview#data-coverage","position":5},{"hierarchy":{"lvl1":"Field Campaigns Overview","lvl3":"Where has SnowEx Been?","lvl2":"Data Coverage"},"type":"lvl3","url":"/notebooks/snowex-data-overview#where-has-snowex-been","position":6},{"hierarchy":{"lvl1":"Field Campaigns Overview","lvl3":"Where has SnowEx Been?","lvl2":"Data Coverage"},"content":"Campaign efforts are focused on various snow climates in the western United States. SnowEx partnerships and expertise are spread across the U.S and international.\n\n\nFigure 1. Map showing the locations of SnowEx field campaign areas (red dot). Base map shows snow classes defined in \n\nSturm and Liston, 2021. The snow pit images show a representative pit in each of the class types visited by SnowEx.\n\nTable 1. Number of manual depths and snow pits associated with NASA SnowEx measurement periods.\n\nSnowEx\n\nField Campaign Location\n\nTemporal Coverage\n\nManual Depths\n\nSnow Pits\n\nS17\n\nGrand Mesa & Senator Beck Basin, Colorado\n\nFebruary 6-25, 2017\n\n23,432\n\n265\n\nS20\n\nGrand Mesa, ColoradoWestern U.S Time Series (13 sites)\n\nNovember 4-7, 2019January 27-February 12, 2020October 24-May 20, 2020*\n\n16,21237,921TBD\n\n21154454\n\nS21\n\nWestern U.S Time Series (7 sites)\n\nNovember 16-May 27, 2021\n\n12,536\n\n247\n\nS23\n\nTundra & Boreal Forest, Alaska (pre-campaign site visit)Tundra & Boreal Forest, AlaskaTundra & Boreal Forest, AlaskaBoreal Forest, AlaskaTundra & Boreal Forest, Alaska\n\nMarch 7-17, 2022October 22-27, 2022March 7-16, 2023April 5-May 6, 2023October 17-28, 2023\n\n10,7289,04926,750TBD6,350\n\n1818617013127\n\n*The majority of sites in 2020 have a temporal coverage of January-March due to the Covid-19 pandemic.\n\n","type":"content","url":"/notebooks/snowex-data-overview#where-has-snowex-been","position":7},{"hierarchy":{"lvl1":"Field Campaigns Overview","lvl3":"Snow Classification Coverage","lvl2":"Data Coverage"},"type":"lvl3","url":"/notebooks/snowex-data-overview#snow-classification-coverage","position":8},{"hierarchy":{"lvl1":"Field Campaigns Overview","lvl3":"Snow Classification Coverage","lvl2":"Data Coverage"},"content":" Thanks to Sturm and Liston 2021 (and 1995), we have a global seasonal snow classification system. This is a vital mission planning tool for remote sensing snow studies. Revised from inception, the snow classification system offers improved utility of the climatological snow classes due to improved (much higher) resolution (300 m over North America). This data set can be found at NSIDC and downloaded at multiple resolutions.\n\n[NSIDC Global Seasonal-Snow Classification, Version 1](https://nsidc.org/data/NSIDC-0768/versions/1) \n\nCheck out [Sturm and Liston, 2021](https://journals.ametsoc.org/view/journals/hydr/22/11/JHM-D-21-0070.1.xml) to find out more \n    \n![](./content/01_snow-classes-sturm.png)\n**Figure 3.** Snow Classes across North America at 300 m (Sturm and Liston, 2021) \n\nAs part of the mission statement, SnowEx aims to quantify snow estimation uncertainty across a range of snow classes, terrain and vegetation types. This is important to determine what areas and time periods have high SWE uncertainty across the ensemble of instrument techniques.\n\n\nFigure 2. Map of the in situ field visits for the duration of SnowEx field campaigns (2017-2023). At this scale, points are overlapping, especially in the eastern Rocky Mountain region around Colorado. The total number of unique visits with recorded SWE are listed in the legend. Upper Right Bar chart of snow classes over the four SnowEx field campaign years. Counts represent in situ field visits. A range of sites in Boreal and Montane Forests occurred in open areas such as meadows and clearings. The snow classification colors match those used in \n\nSturm and Liston, 2021. ![](./content/01_snow-classes-barchart.png)\n**Figure 2.** Bar chart of snow classes over the four SnowEx field campagin years. Counts represent in situ field visits. A range of sites in Boreal and Montane Forests occured in open areas such as meadows and clearings. The snow classification colors match those used in [Sturm and Liston, 2021](https://journals.ametsoc.org/view/journals/hydr/22/11/JHM-D-21-0070.1.xml).   ![](./content/01_map-n-barchart.png)\n**Figure 2.** Bar chart of snow classes over the four SnowEx field campagin years. Counts represent in situ field visits. A range of sites in Boreal and Montane Forests occured in open areas such as meadows and clearings. The snow classification colors match those used in [Sturm and Liston, 2021](https://journals.ametsoc.org/view/journals/hydr/22/11/JHM-D-21-0070.1.xml). \n\n","type":"content","url":"/notebooks/snowex-data-overview#snow-classification-coverage","position":9},{"hierarchy":{"lvl1":"Field Campaigns Overview","lvl3":"Recap","lvl2":"Data Coverage"},"type":"lvl3","url":"/notebooks/snowex-data-overview#recap","position":10},{"hierarchy":{"lvl1":"Field Campaigns Overview","lvl3":"Recap","lvl2":"Data Coverage"},"content":"SnowEx campaigns are structured based on the objectives set out in the SnowEx Science Plan. Some of those objectives are meet by conducting an all hands-on, short and intense observation period (IOP), while others are addressed by studying the evolution of the snowpack over a much longer time series (TS) style campaign.\n\nThe coincident field and airborne campaigns are designed to directly respond to the current knowledge gaps in remote sensing of seasonal snow, thus the participant-driven SnowEx effort targets a range of snow classes, terrain and vegetation types.\n\n","type":"content","url":"/notebooks/snowex-data-overview#recap","position":11},{"hierarchy":{"lvl1":"Field Campaigns Overview","lvl3":"References","lvl2":"Data Coverage"},"type":"lvl3","url":"/notebooks/snowex-data-overview#references","position":12},{"hierarchy":{"lvl1":"Field Campaigns Overview","lvl3":"References","lvl2":"Data Coverage"},"content":"SnowEx Experimental Plans: 2017, \n\n2020, \n\n2021, \n\n2023\n\nSnowEx Science Plan\n\nSturm and Liston, 2021","type":"content","url":"/notebooks/snowex-data-overview#references","position":13},{"hierarchy":{"lvl1":"SnowExSQL Database"},"type":"lvl1","url":"/notebooks/snowexsql-database","position":0},{"hierarchy":{"lvl1":"SnowExSQL Database"},"content":"Tutorial Author Micah’: \n\nMicah Sandusky\n\nTutorial Author Micah_o: \n\nMicah Johnson\n\nSnowEx has introduced a unique opportunity to study SWE in a way that’s unprecedented, but with more data comes new challenges. \n<img src=\"https://snowexsql.readthedocs.io/en/latest/_images/gallery_overview_example_12_0.png\" alt=\"Grand Mesa Overview\" width=\"1000px\"> \n\nThe SnowEx database is a resource that shortcuts the time it takes to ask cross dataset questions\n\nStandardizing diverse data\n\nCross referencing data\n\nProvenance!\n\nAdded GIS functionality\n\nConnect w/ ArcGIS or QGIS!\n\nCITABLE\n\n2022- Estimating snow accumulation and ablation with L-band interferometric synthetic aperture radar (InSAR)\n\n2024 - Thermal infrared shadow-hiding in GOES-R ABI imagery: snow and forest temperature observations from the SnowEx 2020 Grand Mesa field campaign","type":"content","url":"/notebooks/snowexsql-database","position":1},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl3":"What’s in it?"},"type":"lvl3","url":"/notebooks/snowexsql-database#whats-in-it","position":2},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl3":"What’s in it?"},"content":"Snow pits - Density, hardness profiles, grain types + sizes\n\nManual snow depths - TONS of depths (Can you say spirals?)\n\nSnow Micropenetrometer (SMP) profiles - (Subsampled to every 100th)\n\nSnow depth + SWE rasters from ASO Inc.\n\nGPR\n\nPit site notes\n\nCamera Derived snow depths\n\nSnow off DEM from USGS 3DEP\n\nAnd almost all the associated metadata","type":"content","url":"/notebooks/snowexsql-database#whats-in-it","position":3},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl3":"Technically, what is it?"},"type":"lvl3","url":"/notebooks/snowexsql-database#technically-what-is-it","position":4},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl3":"Technically, what is it?"},"content":"PostgreSQL database\n\nPostGIS extension\n\nSupports vector and raster data\n\nAnd a host of GIS operations\n\nAND NOW WITH API!","type":"content","url":"/notebooks/snowexsql-database#technically-what-is-it","position":5},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl4":"So what’s the catch?","lvl3":"Technically, what is it?"},"type":"lvl4","url":"/notebooks/snowexsql-database#so-whats-the-catch","position":6},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl4":"So what’s the catch?","lvl3":"Technically, what is it?"},"content":"New tech can create barriers...\n\n","type":"content","url":"/notebooks/snowexsql-database#so-whats-the-catch","position":7},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl4":"TL;DR Do less wrangling, do more crunching.","lvl3":"Technically, what is it?"},"type":"lvl4","url":"/notebooks/snowexsql-database#tl-dr-do-less-wrangling-do-more-crunching","position":8},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl4":"TL;DR Do less wrangling, do more crunching.","lvl3":"Technically, what is it?"},"content":"\n\n","type":"content","url":"/notebooks/snowexsql-database#tl-dr-do-less-wrangling-do-more-crunching","position":9},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl3":"How do I get at this magical box of data ?"},"type":"lvl3","url":"/notebooks/snowexsql-database#how-do-i-get-at-this-magical-box-of-data","position":10},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl3":"How do I get at this magical box of data ?"},"content":"SQL\n\nsnowexsql \n\n← 😎","type":"content","url":"/notebooks/snowexsql-database#how-do-i-get-at-this-magical-box-of-data","position":11},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl4":"Welcome to API Land","lvl3":"How do I get at this magical box of data ?"},"type":"lvl4","url":"/notebooks/snowexsql-database#welcome-to-api-land","position":12},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl4":"Welcome to API Land","lvl3":"How do I get at this magical box of data ?"},"content":"\n\nfrom snowexsql.api import PointMeasurements\n\ndf = PointMeasurements.from_filter(type=\"depth\", instrument='pit ruler', limit=100)\ndf.plot(column='value', cmap='jet', vmin=10, vmax=150)\ndf\n\n","type":"content","url":"/notebooks/snowexsql-database#welcome-to-api-land","position":13},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl4":"Old Ways / Advanced Users","lvl3":"How do I get at this magical box of data ?"},"type":"lvl4","url":"/notebooks/snowexsql-database#old-ways-advanced-users","position":14},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl4":"Old Ways / Advanced Users","lvl3":"How do I get at this magical box of data ?"},"content":"Advanced queries can be made using SQL or SQAlchemy under the hood.\n\nSee previous presentations\n\nEngine objects, session objects, and a crash course in ORM, oh my!\n\nHackweek 2021\n\nHackweek 2022\n\n","type":"content","url":"/notebooks/snowexsql-database#old-ways-advanced-users","position":15},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl2":"How is the Database Structured?"},"type":"lvl2","url":"/notebooks/snowexsql-database#how-is-the-database-structured","position":16},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl2":"How is the Database Structured?"},"content":"The goal of the database is to hold as much of the SnowEx data in one place and make it easier to\ndo research with. With that in mind follow the steps below to see how the the data base is structured.\n\n","type":"content","url":"/notebooks/snowexsql-database#how-is-the-database-structured","position":17},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl3":"Where do datasets live (i.e. tables)?","lvl2":"How is the Database Structured?"},"type":"lvl3","url":"/notebooks/snowexsql-database#where-do-datasets-live-i-e-tables","position":18},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl3":"Where do datasets live (i.e. tables)?","lvl2":"How is the Database Structured?"},"content":"Data in the database lives in 1 of 4 places.\n\n\n\nLayout of the database tables\n\nThe 4th table is a table detailing the site information. Lots and lots of metadata for which the API has not been written yet.\n\nSo how does this look in python?\n\nfrom snowexsql.api import PointMeasurements, LayerMeasurements, RasterMeasurements\n\n","type":"content","url":"/notebooks/snowexsql-database#where-do-datasets-live-i-e-tables","position":19},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl3":"How are tables structured?","lvl2":"How is the Database Structured?"},"type":"lvl3","url":"/notebooks/snowexsql-database#how-are-tables-structured","position":20},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl3":"How are tables structured?","lvl2":"How is the Database Structured?"},"content":"Each table consists of rows and columns. Below are the available columns!\n\n# Import the class reflecting the points table in the db\nfrom snowexsql.api import PointMeasurements as measurements\n\n# Grab one measurement to see what attributes are available\ndf = measurements.from_filter(type=\"depth\", limit=1)\n\n# Print out the results nicely\nprint(\"These are the available columns in the table:\\n \\n* {}\\n\".format('\\n* '.join(df.columns)))\n\nTry this: Using what we just did, but swap out PointMeasurements for LayerMeasurements.\n\nQuestion: Did you collect any data? What is it? What table do you think it would go in?\n\nFor more detail, checkout the readthedocs page on \n\ndatabase structure to see how data gets categorized.\n\n","type":"content","url":"/notebooks/snowexsql-database#how-are-tables-structured","position":21},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl3":"Bonus Step: Learning to help yourself","lvl2":"How is the Database Structured?"},"type":"lvl3","url":"/notebooks/snowexsql-database#bonus-step-learning-to-help-yourself","position":22},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl3":"Bonus Step: Learning to help yourself","lvl2":"How is the Database Structured?"},"content":"snowexsql has a host of resources for you to  help your self. First when you are looking for something be sure to check the snowexsql’s docs.\nThere you will find notes on the database structure. datasets, and of course our new API!","type":"content","url":"/notebooks/snowexsql-database#bonus-step-learning-to-help-yourself","position":23},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl4":"Database Usage/Examples","lvl3":"Bonus Step: Learning to help yourself","lvl2":"How is the Database Structured?"},"type":"lvl4","url":"/notebooks/snowexsql-database#database-usage-examples","position":24},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl4":"Database Usage/Examples","lvl3":"Bonus Step: Learning to help yourself","lvl2":"How is the Database Structured?"},"content":"snowexsql Code\n\nsnowexsql Documentation","type":"content","url":"/notebooks/snowexsql-database#database-usage-examples","position":25},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl4":"Database Building/Notes","lvl3":"Bonus Step: Learning to help yourself","lvl2":"How is the Database Structured?"},"type":"lvl4","url":"/notebooks/snowexsql-database#database-building-notes","position":26},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl4":"Database Building/Notes","lvl3":"Bonus Step: Learning to help yourself","lvl2":"How is the Database Structured?"},"content":"snowex_db Code\n\nsnowex_db Documentation\n\n","type":"content","url":"/notebooks/snowexsql-database#database-building-notes","position":27},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl3":"Recap","lvl2":"How is the Database Structured?"},"type":"lvl3","url":"/notebooks/snowexsql-database#recap","position":28},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl3":"Recap","lvl2":"How is the Database Structured?"},"content":"You just explored the database structure and discussed how they differ.\n\nYou should know:\n\nWhich table a dataset might live in\n\nWhat columns you can work with (or how to get the available columns)\n\nSome resources to begin helping yourself.\n\nIf you don’t feel comfortable with these, you are probably not alone, let’s discuss it!\n\n","type":"content","url":"/notebooks/snowexsql-database#recap","position":29},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl2":"Forming Queries through the API!"},"type":"lvl2","url":"/notebooks/snowexsql-database#forming-queries-through-the-api","position":30},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl2":"Forming Queries through the API!"},"content":"Get familiar with the tools available for querying the database. The simplest way is to use the api classes\n\nsnowexsql.api.PointMeasurements\n\nsnowexsql.api.LayerMeasurements\n\nEach class has to very useful functions\n\nfrom_filter\n\nfrom_area","type":"content","url":"/notebooks/snowexsql-database#forming-queries-through-the-api","position":31},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl3":"Useful Function - from_filter","lvl2":"Forming Queries through the API!"},"type":"lvl3","url":"/notebooks/snowexsql-database#useful-function-from-filter","position":32},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl3":"Useful Function - from_filter","lvl2":"Forming Queries through the API!"},"content":"Use the from filter function to find density profiles\n\n# Import in our two classes to access the db\nfrom snowexsql.api import LayerMeasurements\nfrom datetime import datetime \n\n# Find some density pit measurements at the Boise site in december 2019.\ndf = LayerMeasurements.from_filter(\n    type=\"density\",\n    site_name=\"Boise River Basin\",\n    date_less_equal=datetime(2020, 1, 1),\n    date_greater_equal=datetime(2019, 12, 1),\n)\n\n# Plot Example!\ndf.plot()\n\n# Show off the dataframe\ndf\n\n# Analysis Example - Find the bulk density \ndf['value'] = df['value'].astype(float)\nprint(df[['site_id', 'value']].groupby(by='site_id').mean())\n\n","type":"content","url":"/notebooks/snowexsql-database#useful-function-from-filter","position":33},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl3":"Useful Function - from_area","lvl2":"Forming Queries through the API!"},"type":"lvl3","url":"/notebooks/snowexsql-database#useful-function-from-area","position":34},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl3":"Useful Function - from_area","lvl2":"Forming Queries through the API!"},"content":"Find specific surface area within a certain distance of a pit.\n\n# Import our api class\nfrom snowexsql.api import LayerMeasurements\nfrom datetime import datetime\nimport geopandas as gpd \n\n# import some gis functionality \nfrom shapely.geometry import Point \n\n# Find some SSA measurements within a distance of a known point\npnt = Point(740820.624625,4.327326e+06)\ndf = LayerMeasurements.from_area(pt=pnt, crs=26912, buffer=500,\n    type='specific_surface_area')\n\n# plot up the results\nax = df.plot()\n\n# plot the site so we can see how close everything is.\nsite = gpd.GeoDataFrame(geometry=[pnt], crs=26912)\nsite.plot(ax=ax, marker='^', color='magenta')\n\n# show off the dataframe\ndf\n\n","type":"content","url":"/notebooks/snowexsql-database#useful-function-from-area","position":35},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl3":"How do I know what to filter on?","lvl2":"Forming Queries through the API!"},"type":"lvl3","url":"/notebooks/snowexsql-database#how-do-i-know-what-to-filter-on","position":36},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl3":"How do I know what to filter on?","lvl2":"Forming Queries through the API!"},"content":"We got tools for that! Each class has a host of functions that start with all_* these function return the unique value in that column.\n\nall_types - all the data types e.g. depth, swe, density...\n\nall_instruments - all instruments available in the table\n\nall_dates - all dates listed in the table\n\nall_site_names - all the site names available in the table. e.g. Grand Mesa\n\nfrom snowexsql.api import PointMeasurements\n\n# Instantiate the class to use the properties!\nmeasurements = PointMeasurements()\n\n# Get the unique data names/types in the table\nresults = measurements.all_types\nprint('Available types = {}'.format(', '.join([str(r) for r in results])))\n\n# Get the unique instrument in the table\nresults = measurements.all_instruments\nprint('\\nAvailable Instruments = {}'.format(', '.join([str(r) for r in results])))\n\n# Get the unique dates in the table\nresults = measurements.all_dates\nprint('\\nAvailable Dates = {}'.format(', '.join([str(r) for r in results])))\n\n# Get the unique site names in the table\nresults = measurements.all_site_names\nprint('\\nAvailable sites = {}'.format(', '.join([str(r) for r in results])))\n\n","type":"content","url":"/notebooks/snowexsql-database#how-do-i-know-what-to-filter-on","position":37},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl4":"More specific filtering options","lvl3":"How do I know what to filter on?","lvl2":"Forming Queries through the API!"},"type":"lvl4","url":"/notebooks/snowexsql-database#more-specific-filtering-options","position":38},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl4":"More specific filtering options","lvl3":"How do I know what to filter on?","lvl2":"Forming Queries through the API!"},"content":"Sometimes we need a bit more filtering to know more about what I can filter on. Questions like “What dates was the SMP used?” are a bit more complicated than “Give me all the dates for snowex”\n\nThe good news is, we have tool for that! from_unique_entries is your friend!\n\n# import layer measurements\nfrom snowexsql.api import LayerMeasurements\n\n# Query dates where SMP was used\nLayerMeasurements.from_unique_entries(['date'], instrument='snowmicropen')\n\n","type":"content","url":"/notebooks/snowexsql-database#more-specific-filtering-options","position":39},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl3":"Query Nuances","lvl2":"Forming Queries through the API!"},"type":"lvl3","url":"/notebooks/snowexsql-database#query-nuances","position":40},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl3":"Query Nuances","lvl2":"Forming Queries through the API!"},"content":"","type":"content","url":"/notebooks/snowexsql-database#query-nuances","position":41},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl4":"Limit size","lvl3":"Query Nuances","lvl2":"Forming Queries through the API!"},"type":"lvl4","url":"/notebooks/snowexsql-database#limit-size","position":42},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl4":"Limit size","lvl3":"Query Nuances","lvl2":"Forming Queries through the API!"},"content":"To avoid accidental large queries, we have added some bumper rails. By default if you ask for more than 1000 records then an error will pop up unless you explicitly say you want more.\n\nTry This: Do a large query. Run the code block below without the limit keyword argument (“kwarg”):\n\n# Import PointMeasurements\nfrom snowexsql.api import PointMeasurements\n\n# Query db using a vague filter or on a huge dataset like GPR but remove the limit kwarg\ndf = PointMeasurements.from_filter(type='two_way_travel', limit=100)\n\n# Show the dataframe\ndf\n\n\n\nWe have added this on the db to allow you to explore without accidentally pulling the entire SnowEx universe down. If you know you want a large query (defined as > 1000) then use the limit = #### option in the from_filter or from_area function.\n\nWarning - It is better to filter using other things besides the limit because the limit is not intelligent. It will simply limit the query by the order of entries that were submitted AND fits your filter. So if you encounter this then consider how to tighten up the filter.","type":"content","url":"/notebooks/snowexsql-database#limit-size","position":43},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl4":"List of Criteria","lvl3":"Query Nuances","lvl2":"Forming Queries through the API!"},"type":"lvl4","url":"/notebooks/snowexsql-database#list-of-criteria","position":44},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl4":"List of Criteria","lvl3":"Query Nuances","lvl2":"Forming Queries through the API!"},"content":"You can use lists in your requests too!\n\n# Import layer measurements\nfrom snowexsql.api import LayerMeasurements\n\n# Grab all the data that used the one of these instruments (hint hint SSA)\nssa_instruments = [\"IS3-SP-15-01US\", \"IRIS\",  \"IS3-SP-11-01F\"]\n\n# Query the DB (throw a limit for safety)\nLayerMeasurements.from_filter(instrument=ssa_instruments, limit=100)\n\n","type":"content","url":"/notebooks/snowexsql-database#list-of-criteria","position":45},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl4":"Greater than or Less than","lvl3":"Query Nuances","lvl2":"Forming Queries through the API!"},"type":"lvl4","url":"/notebooks/snowexsql-database#greater-than-or-less-than","position":46},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl4":"Greater than or Less than","lvl3":"Query Nuances","lvl2":"Forming Queries through the API!"},"content":"Sometimes we want to isolate certain ranges of value or even dates. The greater_equal and less_equal terms can be added on to value or dates.\n\ndate_greater_equal\n\ndate_less_equal\n\nvalue_greater_equal\n\nvalue_less_equal\n\n# Import the point measurements class\nfrom snowexsql.api import PointMeasurements\n\n# Filter values > 100 cm from the pulse ecko GPR\ndf = PointMeasurements.from_filter(value_greater_equal=100, type='depth', instrument='pulse EKKO Pro multi-polarization 1 GHz GPR', limit=100)\n\n# Show off the dataframe\ndf\n\n","type":"content","url":"/notebooks/snowexsql-database#greater-than-or-less-than","position":47},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl3":"Recap","lvl2":"Forming Queries through the API!"},"type":"lvl3","url":"/notebooks/snowexsql-database#recap-1","position":48},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl3":"Recap","lvl2":"Forming Queries through the API!"},"content":"You just came in contact with the new API tools. We can use each API class to pull from specific tables and filter the data.\nYou should know:\n\nHow to build queries using from_filter, from_area, from_unique_entries\n\nDetermine what values to filter on\n\nManage the limit error\n\nFiltering on greater and less than\n\nIf you don’t feel comfortable with these, you are probably not alone, let’s discuss it!\n\n","type":"content","url":"/notebooks/snowexsql-database#recap-1","position":49},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl2":"Exercise: Visualize a Manual Depth Spiral"},"type":"lvl2","url":"/notebooks/snowexsql-database#exercise-visualize-a-manual-depth-spiral","position":50},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl2":"Exercise: Visualize a Manual Depth Spiral"},"content":"During the SnowEx campaigns a TON of manual snow depths were collected, past surveys for hackweek showed an overhelming interest in the manual\nsnow depths dataset. This tutorial shows how easy it is to get at that data in the database while learning how to build queries\n\nGoal: Visualize a small subset of snow depth, ideally a full spiral (mostly cause they are cool!)\n\nApproach:\n\nDetermine the necessary details for isolating manual depths\n\nFind a pit where many spirals were done.\n\nBuffer on the pit location and grab all manual snow depths\n\n","type":"content","url":"/notebooks/snowexsql-database#exercise-visualize-a-manual-depth-spiral","position":51},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl3":"Process","lvl2":"Exercise: Visualize a Manual Depth Spiral"},"type":"lvl3","url":"/notebooks/snowexsql-database#process","position":52},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl3":"Process","lvl2":"Exercise: Visualize a Manual Depth Spiral"},"content":"\n\nfrom snowexsql.api import LayerMeasurements\ndata_type = 'depth'\n\n","type":"content","url":"/notebooks/snowexsql-database#process","position":53},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl4":"Step 1: Find a pit of interest","lvl3":"Process","lvl2":"Exercise: Visualize a Manual Depth Spiral"},"type":"lvl4","url":"/notebooks/snowexsql-database#step-1-find-a-pit-of-interest","position":54},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl4":"Step 1: Find a pit of interest","lvl3":"Process","lvl2":"Exercise: Visualize a Manual Depth Spiral"},"content":"\n\n# Pick the first one we find\nsite_id = LayerMeasurements().all_site_ids[0]\n\n# Query the database, we only need one point to get a site id and its geometry\nsite_df = LayerMeasurements.from_filter(site_id=site_id, limit=1)\n\n# Print it out \nsite_df\n\n","type":"content","url":"/notebooks/snowexsql-database#step-1-find-a-pit-of-interest","position":55},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl4":"Step 2: Collect Snow Depths","lvl3":"Process","lvl2":"Exercise: Visualize a Manual Depth Spiral"},"type":"lvl4","url":"/notebooks/snowexsql-database#step-2-collect-snow-depths","position":56},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl4":"Step 2: Collect Snow Depths","lvl3":"Process","lvl2":"Exercise: Visualize a Manual Depth Spiral"},"content":"\n\n# We import the points measurements because snow depths is a single value at single location and date\nfrom snowexsql.api import PointMeasurements \n\n# Filter the results to within 100m within the point from our pit\ndf = PointMeasurements.from_area(pt=site_df.geometry[0], type=data_type, buffer=200)\ndf\n\n","type":"content","url":"/notebooks/snowexsql-database#step-2-collect-snow-depths","position":57},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl4":"Step 3: Plot it!","lvl3":"Process","lvl2":"Exercise: Visualize a Manual Depth Spiral"},"type":"lvl4","url":"/notebooks/snowexsql-database#step-3-plot-it","position":58},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl4":"Step 3: Plot it!","lvl3":"Process","lvl2":"Exercise: Visualize a Manual Depth Spiral"},"content":"\n\n# Get the Matplotlib Axes object from the dataframe object, color the points by snow depth value\nax = df.plot(column='value', legend=True, cmap='PuBu')\nsite_df.plot(ax=ax, marker='^', color='m')\n\n# Use non-scientific notation for x and y ticks\nax.ticklabel_format(style='plain', useOffset=False)\n\n# Set the various plots x/y labels and title.\nax.set_title(f'{len(df.index)} Manual Snow depths collected at {site_id}')\nax.set_xlabel('Easting [m]')\nax.set_ylabel('Northing [m]')\n\n\nTry This:\n\nA. Go back and add a filter to reduce to just one spiral. What would you change to reduce this?\n\nB. Try to filtering to add more spirals. What happens?","type":"content","url":"/notebooks/snowexsql-database#step-3-plot-it","position":59},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl3":"Recap","lvl2":"Exercise: Visualize a Manual Depth Spiral"},"type":"lvl3","url":"/notebooks/snowexsql-database#recap-2","position":60},{"hierarchy":{"lvl1":"SnowExSQL Database","lvl3":"Recap","lvl2":"Exercise: Visualize a Manual Depth Spiral"},"content":"You just plotted snow depths and reduce the scope of the data by using from_area on it\n\nYou should know:\n\nManual depths are neat.\n\nfilter using from area is pretty slick.\n\nWe can use LayerMeasurements to get site details easily.\n\nIf you don’t feel comfortable with these, you are probably not alone, let’s discuss it!","type":"content","url":"/notebooks/snowexsql-database#recap-2","position":61}]}